%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Template fuer Abschlussarbeiten von Studierenden der 
% Frankfurt University of Applied Sciences
% 
% erstellt von: Prof. Dr.-Ing. Thomas Hollstein
% 
% Last revision: 22.06.2023
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


\documentclass[
    %twoside, 
    %openright,
  titlepage,
  numbers=noenddot,
  headinclude,
    %1headlines,
  footinclude=true,
    %cleardoublepage=empty,
    %BCOR=5mm,
  fontsize=20pt,%20pt,
  paper=a4,
    %letterpaper
    %a4paper,
  ngerman,
  american,
    %table
  ]
% Dokumententyp: (legt grundlegende Formatierrichtlinien fest)
    %{book}
    %{report}
{report}
    %{scrreprt}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


   

% Farbigen Text
\usepackage{xcolor}
\usepackage{adjustbox}

\parindent = 0pt  % Neue Absaetze nicht einruecken
\parskip = 1ex % Neue Absaetze: 1/2 Zeile Abstand





%%%%%%%%%% zu nutzende Pakete einbinden: %%%%%%%%%%

%%%%% Package Kommentare:



\usepackage{comment}
\usepackage[colorinlistoftodos]{todonotes}
\newcommand{\mycomment}[1]{\todo[inline,linecolor=green,backgroundcolor=yellow!25,bordercolor=green,caption={}]{todo: #1}}



%%%%% package Sprachunterstuetzung:

\usepackage{babel}[ngerman]
\usepackage{minted}
\usepackage{csquotes}

%%%%% Package Multirow ermoeglicht, dass sich ein Kaestchen in einer Tabelle ueber mehrere Zeilen erstrecken kann:

\usepackage{multirow}

% Beispiele unter: https://texblog.org/2012/12/21/multi-column-and-multi-row-cells-in-latex-tables/

%Vereinigung von Feldern in Tabellen:
%\multicolumn{number cols}{align}{text} % align: l,c,r
%\multirow{number rows}{width}{text}

%%%% Serifenloser Textstil fuer das ganze Dokument: 

\RequirePackage[sfdefault,lf]{carlito}
\usepackage{lmodern}
% \RequirePackage[T1]{fontenc}
% to imitate Calibri:
\renewcommand*\familydefault{\sfdefault} %% Base font of the document is to be sans serif

%%%%%% Grafiken einbinden
\usepackage{graphicx}
% https://golatex.de//wiki/%5cincludegraphics

%%%%%% Mathematik-Paket AMSMath:
\usepackage[fleqn,reqno]{amsmath}

\usepackage{setspace}


%%%%%% Seitengeometrie einstellen:
% https://tex.stackexchange.com/questions/344241/logo-as-header-using-fancyhdr-package
\usepackage{geometry}
\geometry{verbose,
          bmargin=2.5cm,
          lmargin=2cm,
          rmargin=2cm
          %footskip=-25pt
          }

%%%%%% die Höhe des Top-Margin errechnen:
\newlength\mytopmargin
\newsavebox{\headbox}\savebox{\headbox}{
    %\includegraphics[width=0.3\textwidth]{Figures/xxx.png} \hfill
    \raisebox{-1ex}{\includegraphics[width=0.1\textwidth]{Figures/fra-uas_logo.pdf}}
}    
\setlength{\mytopmargin}{\totalheightof{\usebox{\headbox}}+2cm}
\geometry{verbose,
          tmargin=\mytopmargin,
          headheight=1.1\mytopmargin,
          footskip=9ex
}

% Flexiblere Tabellen
\usepackage{tabularx}
\def\tabularxcolumn#1{m{#1}}

% Boxen für Lickert Skalen
\usepackage{wasysym}
\newcommand\insq[1]{%
    \Square\ #1\quad%
}

% Durchstreichen von Text
\usepackage[normalem]{ulem} % mit \sout



%%%%%% Gesamtseitenzahl verwenden:
\usepackage{totpages}

%%%%%% Kalkulationen:
%https://tex.stackexchange.com/questions/30081/how-can-i-sum-two-values-and-store-the-result-in-other-variable
\usepackage{tikz}
\usetikzlibrary{math}

%%%%%% Gestaltung von Kopf- und Fusszeilen:
% https://tex.stackexchange.com/questions/344241/logo-as-header-using-fancyhdr-package
\usepackage{fancyhdr}
\pagestyle{fancy}  % Eigener Seitenstil
\fancyhf{}         % Alle Kopf- und Fußzeilenfelder bereinigen
%\fancyhead[L]{} % Kopfzeile links
\fancyhead[l]{\leftmark
   %\makebox[0.3\textwidth]{\includegraphics[width=0.3\textwidth]{Figures/xxx.png}}
}  
\fancyhead[c]{\hspace*{0.15\textwidth}\rightmark}
%\fancyhead[C]{\usebox\headbox}                        % Zentrierte Kopfzeile
\fancyhead[R]{
  \makebox[0.2\textwidth]{\raisebox{-1ex}{\hspace*{14ex}\includegraphics[width=0.1\textwidth]{Figures/fra-uas_logo.pdf}}}
}  % Kopfzeile rechts
\renewcommand{\headrulewidth}{0.4pt} % Obere Trennlinie
%\fancyfoot[L]{\today}
\fancyfoot[C]{\ThesisTitleShort} 
%\fancyfoot[R]{Seite \thepage ~von \ref{TotPages}}  % Seitennummer
\fancyfoot[R]{\thepage} % Seitennummer 
\renewcommand{\footrulewidth}{0.4pt} % Untere Trennlinie
\setlength{\mytopmargin}{\totalheightof{\usebox\headbox} +2cm}
%Unterschied zwischen geraden/ungeraden Seiten:
%\fancyhead[OR]{} % "O" steht für "odd", also ungerade Seiten
%\fancyhead[ER]{} % "E" für "even", also gerade Seiten.




%%%%% Erweiterte Formate für Listen/Aufzaehlungen:
\usepackage{paralist}
%Default-Items fuer die vier moeglichen Verschachtelungsebenen:
\setdefaultitem{}{\textbullet}{$\star$}{}

%%%%% FRA-UAS CI Farben:
%\definecolor{airforceblue}{rgb}{0.36, 0.54, 0.66}
% CI-Farben FRA-UAS (blau):
\definecolor{FRAUAS_Blue_Dark}{RGB}{45, 137, 204}
\definecolor{FRAUAS_Blue_Light}{RGB}{182, 210, 228}
% CI-Farben FRA-UAS: FB1
\definecolor{FRAUAS_FB1_Dark}{RGB}{124, 128, 52}
\definecolor{FRAUAS_FB1_Light}{RGB}{213, 213, 179}
% CI-Farben FRA-UAS: FB2
\definecolor{FRAUAS_FB2_Dark}{RGB}{255, 158, 27}
\definecolor{FRAUAS_FB2_Light}{RGB}{251, 221, 173}
% CI-Farben FRA-UAS: FB3
\definecolor{FRAUAS_FB3_Dark}{RGB}{196, 213, 42}
\definecolor{FRAUAS_FB3_Light}{RGB}{237, 240, 166}
% CI-Farben FRA-UAS: FB4
\definecolor{FRAUAS_FB4_Dark}{RGB}{204, 31, 47}
\definecolor{FRAUAS_FB4_Light}{RGB}{240, 166, 183}

%%%%% Sektionstitel nach CI-Farben einfärben:
\usepackage{titlesec}
\titleformat{\section}
{\color{FRAUAS_Blue_Dark}\normalfont\Large\bfseries} %Titel
{\color{FRAUAS_Blue_Dark}\thesection}{1em}{}
\titleformat{\subsection}
{\color{FRAUAS_Blue_Dark}\normalfont\large\bfseries} %Titel
{\color{FRAUAS_Blue_Dark}\thesubsection}{1em}{}

%\usepackage{appendix}

%%%%% Erweiterte Bibliographie-Stile:
%\usepackage{harvard}
% Title Page
% (wir generieren den Titel per Handlayout und verwenden
% daher die folgenden Befehle nicht)
%\title{}
%\author{}

% https://www.overleaf.com/learn/latex/Hyperlinks
\usepackage{hyperref}
\hypersetup{
    %hyperindex=true,
    %linktocpage=true, % Seitenzahl statt Titel verlinkt
    colorlinks=true,
    linkcolor=black,
    filecolor=black,      
    urlcolor=black,
    pdftitle={Thesis},
    pdfpagemode=FullScreen,
    citecolor=black,
    }



%\usepackage[hyphens]{url}  %% stellt \url{} zur Verfuegung

%%%%% modernes BibLaTeX mit biber %%%%%
% https://golatex.de/viewtopic.php?t=13917
%\usepackage[style=ieee-alphabetic,
%backend=biber, natbib=true]{biblatex}

% Literatur nach Erscheinen im Text sortiert
%\usepackage[sorting=none, style=numeric,backend=biber, natbib=true]{biblatex}
%\usepackage[style=apa, backend=biber, natbib=true, sorting=nyt, sortcites=false]{biblatex}
\usepackage[style=numeric, backend=biber, natbib=true, sorting=none, sortcites=false]{biblatex}
% Ohne eingestellte Sortierung
%\usepackage[ style=numeric,
%backend=biber, natbib=true]{biblatex}


\addbibresource{bibliography.bib}

% Immer shortautor anzeigen, falls vorhanden
\makeatletter
\def\cbx@apa@ifnamesaved{\@firstoftwo}
\makeatother

% Zeilenabstand für das ganze Dokument (1.0 = Normalwert):
\renewcommand{\baselinestretch}{1.0}

\usepackage{fontsize}
  \changefontsize[14]{14}

\usepackage[acronym]{glossaries}
\makeglossaries

\usepackage{siunitx}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%% hier beginnt das eigentliche Dokument 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


\begin{document}

%%%%% Settings einbinden:
\input{TeXFiles/000_Settings}
\sloppy %Formatierungsueberstaende am Zeilenende vermeiden
% https://latexref.xyz/_005cfussy-_0026-_005csloppy.html

\frenchspacing  
%Ein Leerzeichen nach Satzende
%https://texwelt.de/fragen/1154/was-ist-french-spacing-was-macht-frenchspacing

%\raggedbottom   
%Standard is \flushbottom, dass heisst
%alle Seiten werden so gedehnt, dass sie 
%gleich hoch sind 
%Schaltet man \raggedbottom ein, ist dies
%nicht so

\ifdefined\ThesisLanguageIsEnglish
\selectlanguage{american}
\else
\selectlanguage{ngerman} % ngerman, american
\fi
%Deutsch nach neuer Rechtschreibung als
%Standardsprache fuer das Dokument einstellen

%\renewcommand*{\bibname}{new name}
%\setbibpreamble{}

% Numerierungstiefe setzen:
% 2: bis subsection (Standard)
% 3: bis subsubsection
\setcounter{secnumdepth}{3} %setzt die Numerierungstiefe



%\renewcommand{\thepage}{\Roman{page}}
\pagestyle{plain} % Seite ohne Kopf- und Fusszeilen darstellen



% hier wird die Titelseite eingebunden:
\input{TeXFiles/001_Titlepage}
\input{TeXFiles/002_NDNotice}
\input{TeXFiles/003_Declaration}
\newpage

% da wir den Titel haendisch erstellt haben entfaellt der folgende Befehl:
%\maketitle

%\clearpage

%\pagestyle{headings} 
\pagestyle{fancy}   % Seite mit Kopf- und Fusszeilen darstellen
\pagenumbering{roman}  % Umschalten auf Seitenzahlen in römischer Darstellung
%\fancyfoot[R]{i}  % Seitennummer
%roemisch 1, hier per Hand eingetragen, weil es anders nicht funktioniert hat - hat sich erledigt


\tableofcontents
\clearpage
\pagenumbering{arabic}  % Umschalten auf Seitenzahlen in arabischer Darstellung
%%%%% Einbinden der Dateien für die einzelnen Sektionen:
% Verwendet man hier \include statt \input, beginnen
% neue Sektionen immer auf einer neuen Seite
%\input{TeXFiles/Abstract}

\fancyfoot[R]{\thepage}  % Seitennummer

%\myName
\setstretch{1.5}
\input{TeXFiles/010_Kurzfassung}
\input{TeXFiles/020_Einleitung}
\input{TeXFiles/030_Grundlagen}
\input{TeXFiles/040_Implementierung}
\input{TeXFiles/050_Ergebnisse}
\input{TeXFiles/080_Zusammenfassung}

\begin{appendix}
  \input{TeXFiles/090_Anhang}
  \clearpage
\end{appendix}

%Falls man die Überschrift des Literaturverzeichnisses
%aendern moechte, geht das durch Verwendung der folgenden Zeile:
%\renewcommand*{\refname}{Literaturverzeichnis}

%\bibliographystyle{plain} % Nummern in eckigen Klammern
%%\bibliographystyle{alpha} % Anfangsbuchstaben Erstautor und Jahr

% Wenn man folgenden Stil verwenden will, dann muss
% \usepackage{harvard} vor \begin{document} aktiviert werden:
%\bibliographystyle{agsm} % (Autoren in runden Klammern)
%\newpage
\clearpage


\phantomsection % Da sonst falsche Verlinkung im Inhaltsverzeichnis
\addcontentsline{toc}{chapter}{Abbildungsverzeichnis}
\listoffigures
\printbibliography[heading=bibintoc]    % Ohne Kapitelnummer /-buchstabe
\end{document}
